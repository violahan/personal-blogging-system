{{!-- Page to display an article --}}

<div id="full-article-container">
    <p>Article ID: {{articleInfo.articleID}}</p>
    <h1>Title: {{articleInfo.title}}</h1>
    
    <h4><a href="./profile?id={{articleInfo.authorID}}">Author: {{articleInfo.userName}}</a></h4>
    <img src="{{articleInfo.avatarFilePath}}" alt="" class="avatar">

    <p>Date: {{articleInfo.publishDate}}</p>

    <h5>Image:</h5>
    {{#if articleImages}}
        <img src="{{articleImages.path}}" alt="">
    {{else}}
        {{!-- NO IMAGE ON THIS ARTICLE --}}
    {{/if}}

    <p>Article content:</p>
    {{{articleInfo.content}}}

</div>

{{!-- Comment text boxes - if user if loged in --}}
{{#if user}}
{{!-- TODO Add button to allow another comment to be added if already added
add onclick button to clear/reset the comment box
add reply buttons for other comments to allow replying
template the comments section to show up via handlebars? --}}
<div>
    <form action="./makeComment?articleID={{articleInfo.articleID}}" method="POST">
        <label for="comment">Enter Comment:</label>
        <textarea name="comment" rows="4" cols="50"></textarea>
        <button type="submit">Post Comment</button>
    </form>
</div>
{{/if}}

{{!-- Display comments on article here --}}
<div>
    <button id="hide-comments-button" onclick="hideComments()">Hide Comments</button>
    <button id="show-comments-button" onclick="showComments()" style="display: none">Show Comments</button>
    <h2>Comments</h2>
    <p id="comments-message"></p>
    <div id="comments-container" onload="getcomments()">

        {{#if commentsToDisplay}}
            {{#each commentsToDisplay}}
            <div class="top-level-comment">                
                <img src="{{this.avatarFilePath}}" alt="" class="avatar">
                <p>Publishdate ={{this.publishDate}}</p>
                <p>CommentID = {{this.commentID}}</p>
                <p>Content = {{this.content}}</p>
                <p> <a href="./profile?id={{this.authorID}}">Username = {{this.userName}}</a></p>
                
                {{#if ../user}}
                <div class="reply-box">
                    <button id="let-reply-{{this.commentID}}" onclick="letReply({{this.commentID}})">Reply</button>
                    <button id="cancel-reply-{{this.commentID}}" onclick="cancelReply({{this.commentID}})" style="display: none">Cancel Reply</button>
                    
                    <form id="reply-form-{{this.commentID}}" action="./makeReply?articleID={{../articleInfo.articleID}}&parentID={{this.commentID}}&commentAuthorID={{../user.userID}}" method="POST" style="display: none">
                        <label for="reply">Enter Reply:</label>
                        <textarea name="reply" rows="4" cols="50"></textarea>
                        <button type="submit">Post Reply</button>
                    </form>
                    
                </div>
                {{/if}}

            </div>
                {{#if this.children}}
                    {{#each this.children}}
                    <div class="level-1-comment">
                        <img src="{{this.avatarFilePath}}" alt="" class="avatar">
                        <p>Publishdate ={{this.publishDate}}</p>
                        <p>CommentID = {{this.commentID}}</p>
                        <p>Content = {{this.content}}</p>
                        <p> <a href="./profile?id={{this.authorID}}">Username = {{this.userName}}</a></p>
                    
                     {{#if ../../user}}
                        <div class="reply-box">
                            <button id="let-reply-{{this.commentID}}" onclick="letReply({{this.commentID}})">Reply</button>
                            <button id="cancel-reply-{{this.commentID}}" onclick="cancelReply({{this.commentID}})" style="display: none">Cancel Reply</button>
                            
                            <form id="reply-form-{{this.commentID}}" action="./makeReply?articleID={{../../articleInfo.articleID}}&parentID={{this.commentID}}&commentAuthorID={{../../user.userID}}" method="POST" style="display: none">
                                <label for="reply">Enter Reply:</label>
                                <textarea name="reply" rows="4" cols="50"></textarea>
                                <button type="submit">Post Reply</button>
                            </form>
                            
                        </div>
                    {{/if}}
                    
                    
                    </div>
                    {{#if this.children}}
                            {{#each this.children}}
                            <div class="level-2-comment">
                                <img src="{{this.avatarFilePath}}" alt="" class="avatar">
                                <p>Publishdate ={{this.publishDate}}</p>
                                <p>CommentID = {{this.commentID}}</p>
                                <p>Content = {{this.content}}</p>4
                                <p> <a href="./profile?id={{this.authorID}}">Username = {{this.userName}}</a></p>
                            </div>
                            {{/each}}
                        {{/if}}
                    {{/each}}
                {{/if}}
            {{/each}}
        {{else}}
            <p>No comments on this article. Yet.</p>
        {{/if}}


    </div>
</div>